# =====================
# SCALARS
# =====================

"A datetime string with format `Y-m-d H:i:s`"
scalar DateTime
  @scalar(class: "Nuwave\\Lighthouse\\Schema\\Types\\Scalars\\DateTime")


"""
=====================
 TYPES
=====================
"""

type User {
  id: ID!
  name: String!
  email: String!
  email_verified_at: DateTime
  created_at: DateTime!
  updated_at: DateTime!
}

type Product {
  id: ID!
  name: String!
  barcode: String
  price: Float!
  cost: Float
  cost_price: Float
  stock: Int!
  unit: String
  size: String
  category: String
  subcategory: String
  main_category: String
  sub_category: String
  status: String
  last_stock_added: Int
  last_stock_added_at: String
  expiry_date: String
  warranty_expiry_date: String
  storage_location: String
  sale_location: String
  created_at: DateTime!
  updated_at: DateTime!
}

type StockMovement {
  id: ID!
  product_id: ID!
  type: String!
  qty: Int!
  device_id: String
  created_at: DateTime!
}

input SyncStockInput {
  id: ID!
  product_id: ID!
  type: String!
  qty: Int!
  device_id: String
  created_at: DateTime!
}


"""
=====================
 QUERIES
=====================
"""
type Query {
  products: [Product!]!
    @field(resolver: "App\\GraphQL\\Queries\\ProductQuery@products")

  stockMovements(product_id: ID!): [StockMovement!]!
    @field(resolver: "App\\GraphQL\\Queries\\StockMovementQuery@byProduct")
}


"""
=====================
 MUTATIONS
=====================
"""
type Mutation {
  createProduct(
    name: String!
    price: Float!
  ): Product
    @create

  syncStockMovements(items: [SyncStockInput!]!): Boolean!  
    @field(resolver: "App\\GraphQL\\Mutations\\SyncStockMovements")

  stockIn(
    product_id: ID!
    qty: Int!
    device_id: String
  ): Boolean!
    @field(resolver: "App\\GraphQL\\Mutations\\StockIn")

  stockOut(
    product_id: ID!
    qty: Int!
    device_id: String
  ): Boolean!
    @field(resolver: "App\\GraphQL\\Mutations\\StockOut")
}
